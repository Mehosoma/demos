/*
// Zerich Catalog menu jQuery plugin 
// Author: Belkin Denis belkin.d.a@yandex.ru
*/
!function(e){e.fn.zerichmenu=function(t){return e.fn.zerichmenu.settings=e.extend({},e.fn.zerichmenu.defaults,t),null===e.fn.zerichmenu.settings.source?("undefined"==typeof console?alert("source cannot be empty"):console.log("source cannot be empty"),this):(this.html(e.fn.zerichmenu.getHtml(e.fn.zerichmenu.settings.source,e.fn.zerichmenu.settings.level)),e(this).on("click","a",{obj:this},function(t){var n=e(this).data("sourceId"),a=[];if(a=e.fn.zerichmenu.search(e.fn.zerichmenu.settings.source,n),e("#catalogtype-menu-line-"+e(this).data("line")+" > .row > .item").removeClass("active"),a&&a.items.length>0||e.fn.zerichmenu.settings.admin){var i=e(this).parent(),l=Math.round(parseInt(e("#catalogtype-menu-line-"+e(this).data("line")).css("width"))/parseInt(i.css("width"))),c=Math.ceil(e(this).data("count")/l)*l;return e.fn.zerichmenu.settings.admin&&a&&0==a.items.length?e.fn.zerichmenu.render([{id:0,url:"#",icon:null,name:"",description:null,parent:n}],e(this).data("line")+1,c):e.fn.zerichmenu.render(a.items,e(this).data("line")+1,c),i.addClass("active"),!1}return!0}),1===document.location.hash.indexOf("catalog")&&e("a[data-source-id="+parseInt(document.location.hash.substring(8))+"]").click(),this)},e.fn.zerichmenu.defaults={source:null,catalogType:1,level:1,admin:!1},e.fn.zerichmenu.getHtml=function(t,n){var a={tag:"div",id:!1,className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"};switch(n){case 1:a.id="catalogtype-menu-line-1";break;case 2:a.id="catalogtype-menu-line-2";break;case 3:a.tag="ul",a.id="catalogtype-menu-line-3",a.className="list-unstyled text-left col-lg-12 col-md-12 col-sm-12 col-xs-12"}var i="<"+a.tag+(a.id?' id="'+a.id+'"':"")+(a.className?' class="'+a.className+'"':"")+">";2===n&&(i+='<div class="row">');for(var l=0;l<t.length;l++)2===n&&(i+='<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12 item item-'+(l+1)+'"><a href="'+t[l].url+'" style="background-image: url('+(null!=t[l].icon?t[l].icon:"/themes/zericheu/images/information.png")+')" data-source-id="'+t[l].id+'" data-line="'+n+'" data-count="'+(l+1)+'">'+t[l].name+"</a>"+(null!==t[l].description&&1!==n&&2!==n?'<p class="text-muted">'+t[l].description+"</p>":"")+"</div>"),3===n&&(i+='<li class="item item-'+(l+1)+'"><a href="'+t[l].url+'" data-source-id="'+t[l].id+'" data-line="'+n+'" data-count="'+(l+1)+'">'+t[l].name+"</a>"+(null!==t[l].description&&1!==n&&2!==n?'<span class="text-muted"> &ndash; '+t[l].description+"</span>":"")+"</li>"),e.fn.zerichmenu.settings.admin&&l===t.length-1&&(2===n&&(i+='<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12 item item-'+l+'"><a href="create.html?ArticleCatalog[catalog_type]='+e.fn.zerichmenu.settings.catalogType+'&ArticleCatalog[parent]=0" style="background-image: url(/images/articleCatalogs/plusik.png)">Добавить корневой каталог</a></div>'),3===n&&(i+='<li class="item item-'+l+'"><a href="create.html?ArticleCatalog[catalog_type]='+e.fn.zerichmenu.settings.catalogType+"&ArticleCatalog[parent]="+t[l].parent+'"><i class="fa fa-plus"></i> Добавить каталог в этот подраздел</a></li>'));return 2===n&&(i+="</div>"),i+="</"+a.tag+">"},e.fn.zerichmenu.render=function(t,n,a){e("#catalogtype-menu-line-"+n).remove(),e("#catalogtype-menu-line-"+(n-1)+" .item-"+a).length>0?e("#catalogtype-menu-line-"+(n-1)+" .item-"+a).after(e.fn.zerichmenu.getHtml(t,n)):e("#catalogtype-menu-line-"+(n-1)+" .row > div:last-child").after(e.fn.zerichmenu.getHtml(t,n)),e("#catalogtype-menu-line-"+n).hide().slideDown()},e.fn.zerichmenu.search=function(t,n){for(var a=0;a<t.length;a++){if(t[a].id==n)return t[a];if(t[a].items.length>0){var i=e.fn.zerichmenu.search(t[a].items,n);if("object"===e.type(i))return i}}}}(jQuery);